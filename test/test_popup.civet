"civet autoConst"

import * as chai from 'chai'

import 'prep-globals.civet'
import { formatter, canonize_url, get_reaction } from '../src/popup.civet'

should = chai.should()

describe 'formatter', =>
  for [ value, expected ] of [
    [ 1202, '1.2K' ], [ 1289, '1.3K' ], [ 12450, '12K' ], [ 1180000, '1.2M' ]
  ]
    it value.toString(), =>
      formatter.format(value).should.equal expected

describe 'canonize_url', =>
  for [ value, expected ] of [
    [ 'https://www.youtube.com/watch?v=abc&t=203',
      'www.youtube.com/watch?v=abc' ],
    [ 'https://www.youtube.com/watch',
      'www.youtube.com/watch' ],
    [ 'https://x.com/LWCnewswire/status/1802676027627286975',
      'x.com/LWCnewswire/status/1802676027627286975' ],
    [ 'https://www.amazon.com/sonichu/s?k=sonichu',
      'www.amazon.com/sonichu/s' ]
  ]
    it value, =>
      canonize_url(value).should.equal expected

describe 'get_reaction', =>
  for [value, expected ] of [[ 0, 1 ], [ 1, 0 ], [ 2, 1 ], [ 3, 0 ]]
    it value.toString(), =>
      get_reaction(value).should.equal expected << value
